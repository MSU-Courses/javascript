# Преобразование типов в JS

В предыдущей теме мы изучили основные типы данных, которые повсеместно используются в JS.

Однако у вас могут возникнуть вопросы. Например, почему `"2" + 3` дает результат 5?

В этой небольшой теме мы рассмотрим преобразование типов, то есть, как строки могут превращаться в числа или как могут быть преобразованы другие типы данных.

Данная тема является необязательной, а дополнительной, для того, чтобы углубить знания и лучше понять преобразование типов данных в JavaScript.

> [!NOTE]
> В JS существует всего 3 типа конвертации: в строку `string`, в число `number` и в логическое значение (true/false) `boolean`

## Явное преобразование

Чтобы явно преобразовать один тип к другому используются соответствующие функции.

```js
String(42); // Приводит к строке (Результат: "42")
Number('42') // Приводит к числу (Результат: 42)
Boolean(42) // Приводит к лог. значению (Результат: true)
```

### Приведение к строке `string`
```js
// приведение `number` к `string`
String(23); // Результат: "23"
String(-25.5); // Результат: "-25.5"
String(NaN); // Результат: "NaN"

// undefined
String(undefined); // Результат: "undefined"

// приведение `boolean` к `string`
String(true); // Результат: true
String(false); Результат: false
```

### Приведение к числу `number`

> [!NOTE]
> Если JavaScript не может привести один тип к другому, то возвращается  `NaN` (Not a Number).

```js
// приведение `string` к `number`
Number("123"); // Результат: 123
Number("12.2"); // Результат: 12.2
Number("-13.3"); // Результат: -13.3
Number("krfgk"); // Результат: NaN
Number("-2,5"); // Результат: NaN (т.к. в JS десятичный разделитель должен быть точкой, а не запятой)

// приведение `boolean` к `number`
Number(true); // Результат: 1
Number(false); // Результат: 0

// undefined
Number(undefined) // Результат: NaN
```

### Приведение к логическому типу `boolean`

```js
// приведение `string` к `boolean`
Boolean(''); // Результат: false (т.к. пустая строка)
Boolean("I am string"); // Результат: true (т.к. не пусткая строка)
Boolean('false'); // Результат: true (т.к. не пусткая строка)

// приведение `number` к `boolean`
Boolean(0); // Результат: false
Boolean(1); // Результат: true
Boolean(NaN); // Результат: false

// undefined
Boolean(undefined); // Результат: false
```

## Неявное преобразование

Выше мы рассмотрели явное преобразование типов, то есть преобразование с помощью функций. Однако на практике такой подход редко используется для преобразования типов.

Это означает, что JavaScript самостоятельно может выполнять преобразования типов во время выполнения программы, что иногда приводит к неожиданным и даже странным результатам, способным сбить с толку даже опытного программиста. Одним из ярких примеров является сложение строки и числа: 
```js
"3" - 2; // Результат: 1
```
В данном случае, операция вычитания будет выполнена, поскольку JavaScript автоматически преобразует строку "3" в число 3, чтобы выполнить арифметическую операцию.

### Приведение к строковому типу данных `string`

> [!IMPORTANT]
> Интерпретатор приведет примитивное значение к строке, если мы используем оператор `+` и один из операндов строка.

```js
"2" + 3; // Результат: "23"
true + ", false" // Результат: true, false 
NaN + "3" // Результат: NaN3
```

### Приведение к числовому типу данных `number`

> [!IMPORTANT]
> Интерпретатор приведет примитивное значение к числу, в случае:
> 1. Используются операторы сравнения `>`, `<`, `<=`, `>=`.
> 2. Используются арифметические операции `-`, `+` (за исключением, если один из операндов строка), `*` и `/`.
> 3. Используется унарный плюса `+'2'`
> 4. Используется оператор нестрогого сравнения `==`

```js
"8" - 6; // Результат: 2
2 - "3"; // Результат: -1
6 - "-6"; // Результат: 12
2 + true; // true преобразовано в 1, результат: 3
+ "2"; // Результат: 2
"2" >= 2; // "2" будет преобразовано в число
9 == "9"; // "9" будет преобразовано в число

// если один из операндов оператора сложения является строкой, то другой операнд преобразуется в строку, как было рассмотрено ранее.
2 + "3"; // Результат: 23
```

> [!NOTE]
> Если преобразование в численный тип невозможно, то результатом будет NaN: ```js
```js
undefined; // Результат: NaN, так как преобразование невозможно
"adf" - 3; // Результат: NaN, так как "adf" невозможно преобразовать в число
```

### Приведение к логическому типу данных `boolean`

> [!IMPORTANT]
> Интерпретатор JavaScript автоматически преобразует примитивные значения к логическим, если они используются в операциях с логическими операторами && (логическое И) или || (логическое ИЛИ).

```js
true && 0;  // `0` преобразуется в false
false || ''; // '' (пустая строка) преобразуется в false
1 && 'hello'; // `1` преобразуется в true, `hello` преобразуется в true.
```

### Преобразование логических операндов с использованием операторов && и ||

Этот раздел является очень важным, поскольку многие сокращения широко применяются в JavaScript.

Например, рассмотрим пример.

```js
false || "hello"; // Результатом будет "hello", но почему?
```

> [!IMPORTANT]
> При использовании оператора `&&`, интерпретатор вернет последний операнд, если все операнды преобразуются в логическое true, иначе вернет первый операнд, который преобразуется в логическое false.

```js
true && false; // Результат: false, так как оба операнда приводятся к логическому true, но результат всего выражения - false
false && "Hello"; // Результат: false, так как первый операнд приводится к логическому false
true && "Hello"; //  Результат: "Hello", так как первый операнд приводится к логическому true
```

> [!IMPORTANT]
> При использовании оператора `||`, интерпретатор вернет первый операнд, который преобразуется в логическое true, иначе вернет последний операнд.

```js
true || false; // Результат: true, так как первый операнд приводится к логическому true
false || "Hello"; // Результат: "Hello", так как первый операнд приводится к логическому false, а второй - к логическому true
0 || ""; // Результат: "", так как оба операнда приводятся к логическому false, но результат всего выражения - ""
```

Приведем примеры из **реальных проектов**.

Допустим, в переменной `userInput` хранятся данные, которые пользователь ввёл в `<input />`
```js
const username = userInput || "Гость";
```
1. Если `userInput` является пустой строкой (то есть пользователь ввёл никакого значение в `input`), то значение переменной `username` будет установлено равным строке `"Гость"`
2. Если пользователь ввел в поле `<input />` свой никнейм (то есть переменная `userInput` не пустая строка), то значение переменной `username` будет установлено на значение переменной `userInput`.

Это позволяет задать значение по умолчанию для переменной `username`, если `userInput` не содержит какого-либо значения или содержит ложное значение.

С помощью конструкции `if`, это можно представить в следующем виде:
```js
let username;
if (userInput) {
    username = userInput;
} else {
    username = "Гость";
}
```
Чувствуется разница?

**Попробуйте сами определить, какой будет результат?**
```js
"Hello" && "World";
NaN || undefined;
undefined || NaN;
```