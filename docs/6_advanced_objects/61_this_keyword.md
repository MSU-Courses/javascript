# Ключевое слово `this`

Из других языков программирования, таких как C++ и Java, вам уже известно о ключевом слове `this`.

В языке JavaScript ключевое слово `this` обозначает почти то же самое, что и в других языках программирования, однако оно обладает своими особенностями.

Многие не понимают, для чего оно используется и как его применять, поскольку оно действительно может вызвать много трудностей.

Мы ограничимся лишь основами данной темы и не будем углубляться в детали, поскольку это может затруднить дальнейшее понимание. 

Попытаемся разобрать данное ключевое слово сразу на практике.

## Ключевое слово `this` в объектах

### Предисловие

Рассмотрим задачу.  Предположим, у нас есть объект `player`, который содержит свойство `username`. Нам нужно создать метод объекта, который выводил бы приветствие и имя пользователя (`username`).

То есть,
```js
const player = {
    username: "Alex",
    greet() {
        // ...
    }
}

player.greet(); // "Hi, my name is Alex"
```

С одной стороны, кажется, что реализация несложная. Попробуем самый банальный способ:

```js
const player = {
    username: "Alex",
    greet() {
        console.log(`Hi, my name is ${username}`);
    }
}

// Uncaught ReferenceError: username is not defined
player.greet();
```

В данном случае выбрасывается ошибка, так как переменная `username` не определена в контексте функции `greet()`.

В других языках данное обращение сработало бы, но в JavaScript контекст выполнения функции `greet()` не подразумевает автоматическое распознавание переменной `username` как свойства объекта. Так как переменная `username` **не была определена внутри функции или не является глобальной переменной**, JavaScript не может найти ее в контексте выполнения функции `greet()`.

Проще говоря, можно сказать, что функция greet не имеет доступа к свойствам объекта, в частности, она не распознает переменную `username`.

Теперь попробуем это сделать по другому.

```js
const player = {
    username: "Alex",
    greet() {
        console.log(`Hi, my name is ${this.username}`);
    }
}

player.greet(); // "Hi, my name is Alex"
```

Теперь программа работает корректно, но мы добавили ключевое слово `this`. Уже поняли, что это такое?

Прежде чем понять, что такое `this`, попробуйте выполнить следующий код.

```js
const player = {
    name: "Alex",
    age: 23,
    greet() {
        console.log("Hi!");
    },
    displayThis() {
        console.log(this);
    }
}

player.displayThis();
// Будет выведено
/* 
{
    name: 'Alex',
    age: 23,
    greet: [Function: greet],
    displayThis: [Function: displayThis]
} 
*/
```

Стало более понятно? 

То есть, в контексте данного примера, в объекте `player` ключевое слово `this` указывает на сам объект `player`.

### `this` в контексте объектов

> [!NOTE]
> `this` в контексте объектов в JS - это ключевое слово, которое ссылается на текущий объект, в контексте которого оно используется.

То есть, более простыми словами, когда мы используем `this`, мы обращаемся к текущему объекту, в котором находится код, где это слово используется.

Еще один пример,

```js
const person = {
  name: 'Alice',
  age: 23,
  greet() {
    console.log(`Hello, my name is ${this.name}, i'm ${this.age} year old`);
  }
};

person.greet(); // Вывод: Hello, my name is Alice
```

Мы можем обойтись без ключевого слова `this`, но в данном случае такой способ не надежен при копировании объектов и **не рекомендуется для использования**.

```js
const person = {
    name: 'Alice',
    greet() {
        console.log(`Hello, my name is ${person.name}.`);
    }
}
```

## `this` — не фиксированное значение

> [!NOTE]
> Ключевое слово `this` не является фиксированным и может меняться в зависимости от контекста, в котором оно используется. То есть простыми словами, `this` зависит от того, где и как используется.

`this` можно использовать в любой функции, объявленной в JavaScript, не обязательно, чтобы это был метод объекта.

Допустим, не будет являться ошибкой следующее выражение.

```js
function greet() {
    console.log(this.name);
}
```

Одно из особенностей `this`, что оно вычисляется во время выполнения кода. То есть одна и та же функция может быть "привязана" к разным объектам.

```js
// Определяем функцию greet(), которая выводит приветственное сообщение,
// используя свойство name объекта, на котором она вызывается
function greet() {
    console.log(`Hi, my name is ${this.name}`);
}

// Создаём объект player с свойством name и методом greet,
// который ссылается на функцию greet()
const player = {
    name: "Player",
    greet,
}

console.log(player.greet()); // Hi, my name is Player

// Создаём объект user с свойством name и методом greet,
// который также ссылается на функцию greet()
const user = {
    name: "User",
    greet,
};

console.log(player.greet()); // Hi, my name is User
```

На данный момент более подробное рассмотрение `this` может вызвать затруднения. Если вы хотите более подробно с ним ознакомиться, то можете прочитать [следующую главу](62_advanced_this.md).